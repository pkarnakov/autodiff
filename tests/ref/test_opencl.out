
TestBasic
cl.Sum(u) / u.size(): 3
cl.Dot(u, v): 30

TestReverse
var_x: Var(MatrixCL<double>, "x")
var_y: Var(MatrixCL<double>, "y")
e.value(): 11.3137
Str(x.grad()):
0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7

Str(y.grad()):
0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7

reverse_cl_1.gv
e.value(): 11.3137
Str(x.grad()):
0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7

Str(y.grad()):
0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7   1
  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 0.7

reverse_cl_2.gv

TestMatrix
u.mean(): 3
u.max(): 3
u.min(): 3
u.dot(v) / u.size(): 30
(u + v).mean(): 13
(u - v).mean(): -7
(u * v).mean(): 30
(u / v).mean(): 0.3
(u + 2).mean(): 5
(2 + u).mean(): 5
(u - 2).mean(): 1
(2 - u).mean(): -1
(u * 2).mean(): 6
(2 * u).mean(): 6
(sin(u)).mean(): 0.14112
(cos(u)).mean(): -0.989992
(exp(u)).mean(): 20.0855
(log(u)).mean(): 1.09861
Matrix<Scal>(u).mean(): 3
MatrixCL<Scal>(Matrix<Scal>(u) + 1, cl).mean(): 4
u(2, 2): 3
u(2, 2) = 17: 17
u(2, 2): 17
(u = v, u.mean()): 10
(u += v, u.mean()): 20
(w = u, w.mean()): 20
Str(iota.roll(0, 0)):
  0   1   2   3
  4   5   6   7
  8   9  10  11
 12  13  14  15

Str(iota.roll(1, 0)):
 12  13  14  15
  0   1   2   3
  4   5   6   7
  8   9  10  11

Str(iota.roll(0, 1)):
  3   0   1   2
  7   4   5   6
 11   8   9  10
 15  12  13  14

Str(iota.roll(1, 1)):
 15  12  13  14
  3   0   1   2
  7   4   5   6
 11   8   9  10

Str(iota.roll(-1, 0)):
  4   5   6   7
  8   9  10  11
 12  13  14  15
  0   1   2   3

Str(iota.roll(0, -1)):
  1   2   3   0
  5   6   7   4
  9  10  11   8
 13  14  15  12

Str(iota.roll(-1, -1)):
  5   6   7   4
  9  10  11   8
 13  14  15  12
  1   2   3   0

Str(u):
  0   1   2   3
  4   5   6   7
  8   9  10  11
 12  13  14  15

rms(u.conv(1, 0, 0, 0, 0) - u): 0
rms(u.conv(0, 1, 0, 0, 0) - u.roll(1, 0)): 0
rms(u.conv(0, 0, 1, 0, 0) - u.roll(-1, 0)): 0
rms(u.conv(0, 0, 0, 1, 0) - u.roll(0, 1)): 0
rms(u.conv(0, 0, 0, 0, 1) - u.roll(0, -1)): 0
Str(u.conv(-4, 1, 1, 1, 1)):
 20  16  16  12
  4   0   0  -4
  4   0   0  -4
-12 -16 -16 -20

